<svg width="1200" height="800" viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: 'Arial', sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: 'Arial', sans-serif; font-size: 16px; font-weight: bold; fill: #34495e; }
      .label { font-family: 'Arial', sans-serif; font-size: 12px; fill: #2c3e50; }
      .small-label { font-family: 'Arial', sans-serif; font-size: 10px; fill: #7f8c8d; }
      .program-box { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .account-box { fill: #e8f6f3; stroke: #27ae60; stroke-width: 2; }
      .user-box { fill: #fef9e7; stroke: #f39c12; stroke-width: 2; }
      .oracle-box { fill: #fadbd8; stroke: #e74c3c; stroke-width: 2; }
      .flow-arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .data-flow { stroke: #8e44ad; stroke-width: 2; fill: none; stroke-dasharray: 5,5; marker-end: url(#arrowhead-purple); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
    </marker>
    <marker id="arrowhead-purple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#8e44ad" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" class="title">Zephron Lending Protocol System Design</text>
  <text x="600" y="50" text-anchor="middle" class="small-label">Program ID: 33s5M4sRp6LBV8mwHJz1EssyhQ3EHrHnDqQ94N1vy74q</text>

  <!-- Main Program -->
  <rect x="480" y="100" width="240" height="80" rx="10" class="program-box"/>
  <text x="600" y="125" text-anchor="middle" class="subtitle">Lending Protocol</text>
  <text x="600" y="145" text-anchor="middle" class="label">Anchor Program</text>
  <text x="600" y="160" text-anchor="middle" class="small-label">init_bank, init_user, deposit,</text>
  <text x="600" y="175" text-anchor="middle" class="small-label">withdraw, borrow, repay, liquidate</text>

  <!-- SOL Bank -->
  <rect x="100" y="250" width="200" height="120" rx="5" class="account-box"/>
  <text x="200" y="270" text-anchor="middle" class="subtitle">SOL Bank</text>
  <text x="200" y="290" text-anchor="middle" class="label">Total Deposits: TDₛₒₗ</text>
  <text x="200" y="305" text-anchor="middle" class="label">Total Borrowed: TBₛₒₗ</text>
  <text x="200" y="320" text-anchor="middle" class="label">Deposit Shares: TDSₛₒₗ</text>
  <text x="200" y="335" text-anchor="middle" class="label">Borrow Shares: TBSₛₒₗ</text>
  <text x="200" y="350" text-anchor="middle" class="label">Liquidation Threshold: LT</text>
  <text x="200" y="365" text-anchor="middle" class="label">Max LTV: maxLTV</text>

  <!-- USDC Bank -->
  <rect x="900" y="250" width="200" height="120" rx="5" class="account-box"/>
  <text x="1000" y="270" text-anchor="middle" class="subtitle">USDC Bank</text>
  <text x="1000" y="290" text-anchor="middle" class="label">Total Deposits: TDᵤₛₔᶜ</text>
  <text x="1000" y="305" text-anchor="middle" class="label">Total Borrowed: TBᵤₛₔᶜ</text>
  <text x="1000" y="320" text-anchor="middle" class="label">Deposit Shares: TDSᵤₛₔᶜ</text>
  <text x="1000" y="335" text-anchor="middle" class="label">Borrow Shares: TBSᵤₛₔᶜ</text>
  <text x="1000" y="350" text-anchor="middle" class="label">Liquidation Threshold: LT</text>
  <text x="1000" y="365" text-anchor="middle" class="label">Max LTV: maxLTV</text>

  <!-- User Account -->
  <rect x="450" y="450" width="300" height="180" rx="5" class="user-box"/>
  <text x="600" y="475" text-anchor="middle" class="subtitle">User Account</text>
  <text x="600" y="500" text-anchor="middle" class="label">SOL Deposited: Dₛₒₗ (Shares: DSₛₒₗ)</text>
  <text x="600" y="515" text-anchor="middle" class="label">SOL Borrowed: Bₛₒₗ (Shares: BSₛₒₗ)</text>
  <text x="600" y="535" text-anchor="middle" class="label">USDC Deposited: Dᵤₛₔᶜ (Shares: DSᵤₛₔᶜ)</text>
  <text x="600" y="550" text-anchor="middle" class="label">USDC Borrowed: Bᵤₛₔᶜ (Shares: BSᵤₛₔᶜ)</text>
  <text x="600" y="570" text-anchor="middle" class="label">Health Factor: HF</text>
  <text x="600" y="585" text-anchor="middle" class="label">Last Updated: timestamp</text>

  <!-- Pyth Oracle -->
  <rect x="500" y="680" width="200" height="80" rx="5" class="oracle-box"/>
  <text x="600" y="705" text-anchor="middle" class="subtitle">Pyth Oracle</text>
  <text x="600" y="725" text-anchor="middle" class="label">SOL/USD Price: Pₛₒₗ_ᵤₛₔ</text>
  <text x="600" y="740" text-anchor="middle" class="label">USDC/USD Price: Pᵤₛₔᶜ_ᵤₛₔ</text>
  <text x="600" y="755" text-anchor="middle" class="small-label">Maximum Age: 100s</text>

  <!-- User Wallet -->
  <rect x="50" y="450" width="200" height="120" rx="5" class="user-box"/>
  <text x="150" y="475" text-anchor="middle" class="subtitle">User Wallet</text>
  <text x="150" y="500" text-anchor="middle" class="label">SOL Token Account</text>
  <text x="150" y="515" text-anchor="middle" class="label">USDC Token Account</text>
  <text x="150" y="535" text-anchor="middle" class="small-label">Associated Token</text>
  <text x="150" y="550" text-anchor="middle" class="small-label">Program (ATP)</text>

  <!-- Bank Treasury Accounts -->
  <rect x="850" y="450" width="300" height="120" rx="5" class="account-box"/>
  <text x="1000" y="475" text-anchor="middle" class="subtitle">Bank Treasury Accounts</text>
  <text x="1000" y="500" text-anchor="middle" class="label">SOL Treasury Account</text>
  <text x="1000" y="515" text-anchor="middle" class="label">USDC Treasury Account</text>
  <text x="1000" y="535" text-anchor="middle" class="small-label">Authority: Bank PDA</text>
  <text x="1000" y="550" text-anchor="middle" class="small-label">Seeds: ["treasury", mint_address]</text>

  <!-- Flows from Program to Banks -->
  <line x1="580" y1="140" x2="280" y2="310" class="flow-arrow"/>
  <text x="430" y="220" class="small-label">manages</text>
  
  <line x1="620" y1="140" x2="980" y2="310" class="flow-arrow"/>
  <text x="800" y="220" class="small-label">manages</text>

  <!-- Flows from Program to User Account -->
  <line x1="580" y1="180" x2="520" y2="450" class="flow-arrow"/>
  <text x="550" y="315" class="small-label">tracks</text>

  <!-- Flows from User Wallet to Banks -->
  <line x1="250" y1="510" x2="280" y2="370" class="flow-arrow"/>
  <text x="265" y="440" class="small-label">deposit</text>
  
  <line x1="250" y1="510" x2="980" y2="370" class="flow-arrow"/>
  <text x="615" y="440" class="small-label">deposit</text>

  <!-- Flows from Banks to User Wallet -->
  <line x1="280" y1="370" x2="250" y2="510" class="flow-arrow"/>
  <text x="265" y="440" class="small-label">borrow</text>
  
  <line x1="980" y1="370" x2="250" y2="510" class="flow-arrow"/>
  <text x="615" y="440" class="small-label">borrow</text>

  <!-- Data flow from Oracle to Program -->
  <line x1="600" y1="680" x2="600" y2="180" class="data-flow"/>
  <text x="620" y="430" class="small-label">price feeds</text>

  <!-- Key Formulas -->
  <rect x="50" y="100" width="300" height="140" rx="5" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1"/>
  <text x="200" y="125" text-anchor="middle" class="subtitle">Key Formulas</text>
  <text x="60" y="150" class="small-label">Total Collateral = (Dₛₒₗ × Pₛₒₗ_ᵤₛₔ) + (Dᵤₛₔᶜ × Pᵤₛₔᶜ_ᵤₛₔ)</text>
  <text x="60" y="165" class="small-label">Total Borrowed = (Bₛₒₗ × Pₛₒₗ_ᵤₛₔ) + (Bᵤₛₔᶜ × Pᵤₛₔᶜ_ᵤₛₔ)</text>
  <text x="60" y="180" class="small-label">Health Factor = (Total Collateral × LT) / Total Borrowed</text>
  <text x="60" y="195" class="small-label">Max Borrowable = Total Collateral × maxLTV</text>
  <text x="60" y="210" class="small-label">Liquidation: HF &lt; 1.0</text>
  <text x="60" y="225" class="small-label">Shares Ratio = Amount / Total Amount</text>

  <!-- Legend -->
  <rect x="850" y="100" width="250" height="140" rx="5" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1"/>
  <text x="975" y="125" text-anchor="middle" class="subtitle">Legend</text>
  <rect x="860" y="135" width="15" height="10" class="program-box"/>
  <text x="885" y="145" class="small-label">Smart Contract</text>
  <rect x="860" y="150" width="15" height="10" class="account-box"/>
  <text x="885" y="160" class="small-label">Protocol Account</text>
  <rect x="860" y="165" width="15" height="10" class="user-box"/>
  <text x="885" y="175" class="small-label">User Account</text>
  <rect x="860" y="180" width="15" height="10" class="oracle-box"/>
  <text x="885" y="190" class="small-label">External Oracle</text>
  <line x1="860" y1="200" x2="875" y2="200" class="flow-arrow"/>
  <text x="885" y="205" class="small-label">Transaction Flow</text>
  <line x1="860" y1="215" x2="875" y2="215" class="data-flow"/>
  <text x="885" y="220" class="small-label">Data Feed</text>

</svg>
